# Mac Agent å·¥å…·æµ‹è¯•ä½¿ç”¨æŒ‡å—

> **å¿«é€Ÿå‚è€ƒ**: å¦‚ä½•è¿è¡Œæµ‹è¯•å’ŒæŸ¥çœ‹ç»“æœ

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œæ‰€æœ‰å·¥å…·æµ‹è¯•

```bash
cd /Users/xinfuzhang/Desktop/Code/mac_agent/backend
source .venv/bin/activate
python tests/run_tool_tests.py
```

**è¾“å‡º**:
- å®æ—¶æ˜¾ç¤ºæµ‹è¯•è¿›åº¦
- è‡ªåŠ¨ç”ŸæˆJSONå’ŒMarkdownæŠ¥å‘Š
- ä¿å­˜åœ¨ `tests/test_results/` ç›®å½•

---

## ğŸ“Š æŸ¥çœ‹æµ‹è¯•ç»“æœ

### æ–¹å¼1: äº¤äº’å¼æŸ¥çœ‹å™¨ï¼ˆæ¨èï¼‰

```bash
python tests/view_results.py
```

**åŠŸèƒ½èœå•**:
```
1. æŸ¥çœ‹æµ‹è¯•æ‘˜è¦
2. æŸ¥çœ‹å·¥å…·åˆ—è¡¨
3. æŸ¥çœ‹å¤±è´¥çš„æµ‹è¯•
4. æŸ¥çœ‹é€šè¿‡çš„æµ‹è¯•
5. æŒ‰å·¥å…·åç§°æŸ¥çœ‹
6. æŸ¥çœ‹æ‰€æœ‰æµ‹è¯•è¯¦æƒ…
0. é€€å‡º
```

### æ–¹å¼2: å‘½ä»¤è¡Œå¿«é€ŸæŸ¥çœ‹

```bash
# æŸ¥çœ‹æµ‹è¯•æ‘˜è¦
python tests/view_results.py summary

# æŸ¥çœ‹å·¥å…·åˆ—è¡¨
python tests/view_results.py list

# æŸ¥çœ‹å¤±è´¥çš„æµ‹è¯•
python tests/view_results.py failed

# æŸ¥çœ‹æ‰€æœ‰æµ‹è¯•è¯¦æƒ…
python tests/view_results.py all
```

### æ–¹å¼3: ç›´æ¥æŸ¥çœ‹æ–‡ä»¶

```bash
# æŸ¥çœ‹æœ€æ–°çš„MarkdownæŠ¥å‘Š
ls -lt tests/test_results/*.md | head -1 | awk '{print $NF}' | xargs open

# æŸ¥çœ‹JSONæ•°æ®ï¼ˆéœ€è¦jqï¼‰
ls -lt tests/test_results/*.json | head -1 | awk '{print $NF}' | xargs cat | jq
```

---

## ğŸ“ æµ‹è¯•ç»“æœæ–‡ä»¶ä½ç½®

```
backend/tests/test_results/
â”œâ”€â”€ test_results_20260129_165320.json    # JSONæ ¼å¼ï¼ˆç¨‹åºå¯è¯»ï¼‰
â””â”€â”€ test_report_20260129_165320.md       # Markdownæ ¼å¼ï¼ˆäººç±»å¯è¯»ï¼‰
```

**æ–‡ä»¶å‘½åè§„åˆ™**: `test_results_YYYYMMDD_HHMMSS.json`

---

## ğŸ” æŸ¥çœ‹ç‰¹å®šå·¥å…·çš„æµ‹è¯•ç»“æœ

### ä½¿ç”¨äº¤äº’å¼æŸ¥çœ‹å™¨

```bash
python tests/view_results.py
# é€‰æ‹© 5 (æŒ‰å·¥å…·åç§°æŸ¥çœ‹)
# è¾“å…¥å·¥å…·åç§°ï¼Œä¾‹å¦‚: system_info
```

### ä½¿ç”¨jqæŸ¥è¯¢JSON

```bash
# æŸ¥çœ‹system_infoå·¥å…·çš„æµ‹è¯•ç»“æœ
cat tests/test_results/test_results_*.json | jq '.tests[] | select(.tool_name == "system_info")'

# æŸ¥çœ‹æ‰€æœ‰å¤±è´¥çš„æµ‹è¯•
cat tests/test_results/test_results_*.json | jq '.tests[] | select(.success == false)'

# ç»Ÿè®¡å„å·¥å…·çš„æµ‹è¯•æ•°é‡
cat tests/test_results/test_results_*.json | jq '.tests | group_by(.tool_name) | map({tool: .[0].tool_name, count: length})'
```

---

## ğŸ› ï¸ æ·»åŠ æ–°çš„æµ‹è¯•ç”¨ä¾‹

### æ­¥éª¤1: ç¼–è¾‘é…ç½®æ–‡ä»¶

ç¼–è¾‘ `tests/test_cases_config.py`:

```python
TEST_CASES = {
    # ... ç°æœ‰é…ç½® ...
    
    "your_tool_name": [
        {
            "description": "æµ‹è¯•æè¿°",
            "args": {
                "param1": "value1",
                "param2": "value2"
            },
            "expect_failure": False  # å¯é€‰ï¼Œæ ‡è®°é¢„æœŸå¤±è´¥
        },
        {
            "description": "å¦ä¸€ä¸ªæµ‹è¯•åœºæ™¯",
            "args": {
                "param1": "different_value"
            }
        }
    ],
}
```

### æ­¥éª¤2: è¿è¡Œæµ‹è¯•

```bash
python tests/run_tool_tests.py
```

### æ­¥éª¤3: æŸ¥çœ‹ç»“æœ

```bash
python tests/view_results.py summary
```

---

## ğŸ“Š æµ‹è¯•ç»“æœç¤ºä¾‹

### æˆåŠŸçš„æµ‹è¯•

```json
{
  "tool_name": "system_info",
  "description": "è·å–ç³»ç»ŸåŸºæœ¬ä¿¡æ¯",
  "success": true,
  "input": {},
  "output": {
    "ok": true,
    "data": {
      "sw_vers": { ... },
      "uname": { ... },
      "cpu": { ... },
      "mem_bytes": { ... }
    }
  },
  "error": null,
  "timestamp": "2026-01-29T16:53:20.123456"
}
```

### å¤±è´¥çš„æµ‹è¯•

```json
{
  "tool_name": "spotlight_search",
  "description": "ä½¿ç”¨Spotlightæœç´¢Pythonæ–‡ä»¶",
  "success": false,
  "input": {
    "query": "*.py",
    "limit": 5
  },
  "output": {
    "ok": false,
    "error": "æœç´¢å¤±è´¥"
  },
  "error": "æœç´¢å¤±è´¥",
  "timestamp": "2026-01-29T16:53:25.654321"
}
```

---

## ğŸ¯ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
cd /Users/xinfuzhang/Desktop/Code/mac_agent/backend
source .venv/bin/activate

# è¿è¡Œæµ‹è¯•
python tests/run_tool_tests.py

# æŸ¥çœ‹æ‘˜è¦
python tests/view_results.py summary

# æŸ¥çœ‹å·¥å…·åˆ—è¡¨
python tests/view_results.py list

# æŸ¥çœ‹å¤±è´¥çš„æµ‹è¯•
python tests/view_results.py failed

# äº¤äº’å¼æŸ¥çœ‹
python tests/view_results.py

# æŸ¥çœ‹æœ€æ–°æŠ¥å‘Š
open tests/test_results/test_report_*.md
```

---

## ğŸ“ˆ æµ‹è¯•ç»Ÿè®¡

### å½“å‰æµ‹è¯•è¦†ç›–

- **å·¥å…·æ€»æ•°**: 50ä¸ª
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 60ä¸ª
- **æµ‹è¯•æˆåŠŸç‡**: 93.3%
- **é€šè¿‡**: 56ä¸ª
- **å¤±è´¥**: 4ä¸ªï¼ˆ3ä¸ªé¢„æœŸå¤±è´¥ï¼Œ1ä¸ªéœ€ä¿®å¤ï¼‰

### æŒ‰åˆ†ç±»ç»Ÿè®¡

| åˆ†ç±» | å·¥å…·æ•° | æµ‹è¯•ç”¨ä¾‹ | æˆåŠŸç‡ |
|------|--------|---------|--------|
| ç³»ç»Ÿä¿¡æ¯ | 4 | 4 | 100% |
| è¿›ç¨‹ç®¡ç† | 3 | 4 | 100% |
| ç½‘ç»œå·¥å…· | 7 | 9 | 89% |
| æ–‡ä»¶ç®¡ç† | 10 | 13 | 100% |
| Shellå‘½ä»¤ | 4 | 6 | 83% |
| å…¶ä»– | 22 | 24 | 96% |

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜1: æµ‹è¯•å¤±è´¥ - PILåº“æœªå®‰è£…

```bash
pip install pillow
```

### é—®é¢˜2: æƒé™é”™è¯¯

```bash
# ç¡®ä¿æµ‹è¯•æ•°æ®ç›®å½•æœ‰å†™æƒé™
chmod -R 755 tests/test_data/
```

### é—®é¢˜3: æ‰¾ä¸åˆ°æµ‹è¯•ç»“æœ

```bash
# æ£€æŸ¥ç»“æœç›®å½•
ls -la tests/test_results/

# é‡æ–°è¿è¡Œæµ‹è¯•
python tests/run_tool_tests.py
```

### é—®é¢˜4: JSONæ ¼å¼é”™è¯¯

```bash
# ä½¿ç”¨jqéªŒè¯JSONæ ¼å¼
cat tests/test_results/test_results_*.json | jq empty
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **å®Œæ•´æµ‹è¯•æŠ¥å‘Š**: `backend/docs/å·¥å…·æµ‹è¯•å®Œæ•´æŠ¥å‘Š_20260129.md`
- **å·¥å…·è¯´æ˜æ–‡æ¡£**: `backend/docs/mac_agent_å·¥å…·è¯´æ˜_20260129.md`
- **æµ‹è¯•æ¡†æ¶æ–‡æ¡£**: `backend/tests/tools/README.md`
- **å¿«é€Ÿå¼€å§‹æŒ‡å—**: `backend/tests/tools/QUICKSTART.md`

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å®šæœŸè¿è¡Œæµ‹è¯•

```bash
# æ¯æ¬¡ä¿®æ”¹ä»£ç åè¿è¡Œ
python tests/run_tool_tests.py

# æŸ¥çœ‹æ˜¯å¦æœ‰æ–°çš„å¤±è´¥
python tests/view_results.py failed
```

### 2. ä¿å­˜æµ‹è¯•å†å²

```bash
# æµ‹è¯•ç»“æœä¼šè‡ªåŠ¨ä¿å­˜ï¼Œæ–‡ä»¶ååŒ…å«æ—¶é—´æˆ³
# å¯ä»¥å¯¹æ¯”ä¸åŒæ—¶é—´çš„æµ‹è¯•ç»“æœ

# æŸ¥çœ‹æ‰€æœ‰æµ‹è¯•å†å²
ls -lh tests/test_results/
```

### 3. å…³æ³¨å¤±è´¥æµ‹è¯•

```bash
# å¿«é€ŸæŸ¥çœ‹å¤±è´¥çš„æµ‹è¯•
python tests/view_results.py failed

# åˆ†æå¤±è´¥åŸå› 
# ä¿®å¤é—®é¢˜åé‡æ–°æµ‹è¯•
```

### 4. æ·»åŠ æ–°æµ‹è¯•

```bash
# 1. ç¼–è¾‘ tests/test_cases_config.py
# 2. æ·»åŠ æ–°çš„æµ‹è¯•ç”¨ä¾‹
# 3. è¿è¡Œæµ‹è¯•éªŒè¯
python tests/run_tool_tests.py
```

---

## ğŸ“ è¿›é˜¶ç”¨æ³•

### ä½¿ç”¨jqåˆ†ææµ‹è¯•æ•°æ®

```bash
# ç»Ÿè®¡æ¯ä¸ªå·¥å…·çš„å¹³å‡æ‰§è¡Œæ—¶é—´ï¼ˆå¦‚æœè®°å½•äº†æ—¶é—´ï¼‰
cat tests/test_results/test_results_*.json | jq '.tests | group_by(.tool_name) | map({tool: .[0].tool_name, count: length})'

# æŸ¥æ‰¾ç‰¹å®šé”™è¯¯
cat tests/test_results/test_results_*.json | jq '.tests[] | select(.error != null) | {tool: .tool_name, error: .error}'

# å¯¼å‡ºå¤±è´¥æµ‹è¯•åˆ°CSV
cat tests/test_results/test_results_*.json | jq -r '.tests[] | select(.success == false) | [.tool_name, .description, .error] | @csv' > failed_tests.csv
```

### è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬

```bash
#!/bin/bash
# auto_test.sh - è‡ªåŠ¨è¿è¡Œæµ‹è¯•å¹¶å‘é€é€šçŸ¥

cd /Users/xinfuzhang/Desktop/Code/mac_agent/backend
source .venv/bin/activate

# è¿è¡Œæµ‹è¯•
python tests/run_tool_tests.py

# æ£€æŸ¥ç»“æœ
if [ $? -eq 0 ]; then
    echo "âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡"
else
    echo "âŒ æœ‰æµ‹è¯•å¤±è´¥"
    python tests/view_results.py failed
fi
```

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹:
1. å®Œæ•´æµ‹è¯•æŠ¥å‘Š: `backend/docs/å·¥å…·æµ‹è¯•å®Œæ•´æŠ¥å‘Š_20260129.md`
2. å·¥å…·è¯´æ˜: `backend/docs/mac_agent_å·¥å…·è¯´æ˜_20260129.md`
3. æµ‹è¯•æ¡†æ¶æ–‡æ¡£: `backend/tests/tools/README.md`

---

**æœ€åæ›´æ–°**: 2026-01-29  
**ç‰ˆæœ¬**: 1.0
