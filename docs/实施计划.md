## 实施计划（生产级）

### 1. 目标与范围
- 目标：搭建基于 OpenAI 协议的 macOS 管理智能体，支持多轮工具调用、可审计、可扩展。
- 范围：系统信息、磁盘、进程、网络、应用打开、文件管理等低风险能力；安全与权限边界明确。
- 非范围：未授权提权操作、破坏安全策略、清空系统目录等高危操作。

### 2. 架构设计
- **核心层**：LLM 客户端、对话与工具调用循环、错误与超时控制。
- **工具层**：可插拔 Tool Registry，支持快速新增工具。
- **安全层**：路径与命令约束、超时控制、最小权限原则、返回结构化结果。
- **执行层**：统一命令执行器，标准化 stdout/stderr/exit_code。

### 3. 里程碑
- **M1（基础可用）**：完成 LLM 对接、多轮工具调用、核心安全检查。
- **M2（工具丰富）**：补齐系统/网络/磁盘/应用/文件工具集。
- **M3（生产化）**：完善错误处理、可观测性、策略与审计扩展点。

### 4. 安全策略
- 默认允许的路径：`Home/Desktop/Documents/Downloads`。
- 命令与参数严格白名单；禁用任意 shell 拼接。
- 对潜在高风险操作返回替代方案或拒绝执行。

### 5. 质量保障
- 单元测试覆盖核心组件与工具边界条件。
- 接口契约测试：工具参数合法性与响应格式。
- 运行时验证：超时、异常与错误码处理一致。

### 6. 运维与部署
- 通过环境变量配置 base_url、model、api_key、超时与工具轮次上限。
- 默认日志输出到标准输出，便于容器化或本地运行。
